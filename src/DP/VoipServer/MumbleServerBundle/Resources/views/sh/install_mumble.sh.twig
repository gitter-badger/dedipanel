#!/bin/bash

# Copyright (C) 2010-2012 Kerouanton Albin, Smedts Jérôme
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License along
# with this program; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.

MUMBLE_UNZIP='murmur-static_x86-1.2.3'
MUMBLE_VERSION='murmur-static_x86-1.2.3.tar.bz2'
MUMBLE_URL='http://freefr.dl.sourceforge.net/project/mumble/Mumble/1.2.3/'
INSTALL_DIR='/home/dp/mumble/'

    cd "$INSTALL_DIR"

    # On commence par télécharger le serveur mumble
    wget "$MUMBLE_URL/$MUMBLE_VERSION"
    
    # On décompresse l'archive et on la supprime 
    tar xjf $INSTALL_DIR$MUMBLE_VERSION && rm -f $INSTALL_DIR$MUMBLE_VERSION
    
    # On deplace tout du dossier de décompression et on supprime le dossier inutile
    find $INSTALL_DIR$MUMBLE_UNZIP -type f -exec mv {} $INSTALL_DIR \;
    rm -r $INSTALL_DIR$MUMBLE_UNZIP
    
    # Une fois dans le dossier on donne les droit au binaire mumble
    if [ -d '$INSTALL_DIR'murmur.x86 ]; then
        echo "Install aborded" >> "$INSTALL_DIR"install.log
    else
        chmod +x murmur.x86        
        echo "Install ended" >> "$INSTALL_DIR"install.log
    fi